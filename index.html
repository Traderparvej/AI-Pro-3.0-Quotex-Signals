<div id="notice" class="notice"></div>

<script>
const passwords=['@Ai100','Parvej4067'];
const realAssets=[/* à¦†à¦—à§‡à¦° à¦®à¦¤à§‹ assets */];
const otcAssets=[/* à¦†à¦—à§‡à¦° à¦®à¦¤à§‹ assets */];

let canGenerate = true;
let signalEndTime = null;
let consecutiveLosses = 0;
let consecutiveProfit = 0;
let waitingForResult = false;

const marketSelect = document.getElementById('market');
const pairSelect = document.getElementById('pair');
const timezoneSelect = document.getElementById('timezone');
const noticeDiv = document.getElementById('notice');

function updatePairOptions() {
    const marketType = marketSelect.value;
    const assets = marketType==='real'?realAssets:otcAssets;
    pairSelect.innerHTML='';
    assets.forEach(a=>{
        const opt = document.createElement('option');
        opt.value = a;
        opt.textContent = a;
        pairSelect.appendChild(opt);
    });
}
updatePairOptions();
marketSelect.addEventListener('change', updatePairOptions);

function checkLogin(){
    const input=document.getElementById('password').value;
    if(!passwords.includes(input)){
        alert('Password is incorrect!');
        return;
    }
    document.getElementById('loginContainer').style.display='none';
    document.getElementById('tradingContainer').style.display='flex';
}

function showNotice(message){
    noticeDiv.textContent = message;
    noticeDiv.classList.add('show');
    setTimeout(()=>noticeDiv.classList.remove('show'),8000);
}

function generateSignals(){
    if(!canGenerate){ alert('Please wait or select previous signal result.'); return; }

    const asset = pairSelect.value;
    const randomGap = Math.floor(Math.random()*3)+1; // 1-3 min
    signalEndTime = new Date(Date.now() + randomGap*60000);

    const tzOffset = parseInt(timezoneSelect.value);
    const signalDate = new Date(Date.now() + randomGap*60000 + tzOffset*3600000);
    const hours = signalDate.getUTCHours().toString().padStart(2,'0');
    const minutes = signalDate.getUTCMinutes().toString().padStart(2,'0');

    const card=document.createElement('div');
    card.className='signal-card';
    card.innerHTML=`
<span class="signal-title">Quotex Real Time Signals â€“ AI Pro 3.0</span>
ğŸ§  Opposite Candle Stage:
à¦†à¦—à§‡à¦° à¦•à§à¦¯à¦¾à¦¨à§à¦¡à§‡à¦² à¦…à¦¨à§à¦¯à¦¾à¦¯à¦¼à§€ à¦¬à¦¿à¦ªà¦°à§€à¦¤à§‡ à¦Ÿà§à¦°à§‡à¦¡ â¤ï¸

â•”â•â•â•â• â‰ªâ€¢â—¦ âˆ â—¦â€¢â‰« â•â•â•â•â•—
${hours}:${minutes} â€“ ${asset}
â•šâ•â•â•â• â‰ªâ€¢â—¦ âˆ â—¦â€¢â‰« â•â•â•â•â•

<div class="winloss-buttons">
<button onclick="registerWin(this)">WIN</button>
<button onclick="registerLoss(this)">LOSS</button>
</div>

â˜ ï¸ AI Trading Rules â˜ ï¸
ğŸš« Avoid Signals:
â¤Doji  â¤Market <80%  â¤Gap Up/Down  â¤1-Step MTG

<a href="https://t.me/QxParvej" target="_blank">Join Community</a>
    `;
    document.getElementById('signalList').prepend(card);

    canGenerate=false;
    waitingForResult=true;

    const interval = setInterval(()=>{
        const remaining = Math.floor((signalEndTime-new Date())/1000);
        const btn = document.getElementById('generateBtn');
        if(remaining>0) btn.textContent=`Wait: ${Math.floor(remaining/60)}m ${remaining%60}s`;
        else{
            btn.textContent='Generate Signal';
            clearInterval(interval);
        }
    },1000);
}

function registerWin(button){
    consecutiveProfit++;
    consecutiveLosses=0;
    waitingForResult=false;
    canGenerate=true;
    clearSignalBox();

    if(consecutiveProfit >= 5){
        showNotice('Back to back 5 Profit, à¦†à¦²à¦¹à¦¾à¦®à¦¦à§à¦²à¦¿à¦²à§à¦²à¦¾à¦¹! à§ª-à§« à¦˜à¦¨à§à¦Ÿà¦¾ à¦œà¦¨à§à¦¯ à¦Ÿà§à¦°à§‡à¦¡ à¦¬à¦¨à§à¦§ à¦°à¦¾à¦–à§à¦¨à¥¤');
        consecutiveProfit=0; // Reset
    }
}

function registerLoss(button){
    consecutiveLosses++;
    consecutiveProfit=0;
    waitingForResult=false;
    canGenerate=true;
    clearSignalBox();

    if(consecutiveLosses >= 2){
        showNotice('à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨à§‡ à¦®à¦¾à¦°à§à¦•à§‡à¦Ÿ à¦­à¦¾à¦²à§‹ à¦¨à¦¾, à§¨-à§© à¦˜à¦£à§à¦Ÿà¦¾ à¦ªà¦° à¦Ÿà§à¦°à§‡à¦¡ à¦•à¦°à§à¦¨à¥¤');
        consecutiveLosses=0; // Reset
    }
}

function clearSignalBox(){
    document.getElementById('signalList').innerHTML='';
    canGenerate=true;
    document.getElementById('generateBtn').textContent='Generate Signal';
}

function copyAllSignals(){
    const list=document.getElementById('signalList');
    let text='';
    list.querySelectorAll('.signal-card').forEach(div=>{
        const cloned = div.cloneNode(true);
        cloned.querySelectorAll('button').forEach(b=>b.remove());
        text+=cloned.textContent+'\n';
    });
    navigator.clipboard.writeText(text).then(()=>alert('Copied to clipboard!'));
}
</script>
